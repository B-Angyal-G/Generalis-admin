def result_check(GRAPH, SCALE):
    OK = 1
    for row in range(len(GRAPH)):
        s = 0
        for col in GRAPH[row]:
            if col[1] != 0:
                s += 1
        if s > 1:
            OK = 0
            print('ALERT:', row, 'sorban tobb el lett kivalasztva', s)
        elif s < 1:
            OK = 0
            print('ALERT:', row, 'sorban kevesebb lett kivalasztva', s)

    for col in range(len(GRAPH[0])):
        s = 0
        for row in GRAPH:
            if row[col][1] != 0:
                s += 1
        if s > SCALE:
            OK = 0
            print('ALERT:', col, 'col tobb el lett kivalasztva', s)
        elif s < SCALE:
            OK = 0
            print('ALERT:', col, 'col kevesebb lett kivalasztva', s)

    if OK:
        print('ELLENORZES RENDBEN', SCALE)


def hun_repair_init (G, A, B):
    ### UA SIMPLE ES DOUBLE ESETEKBEN
    OK = 0
    ### 0-AS INDEXU CSUCSOK KIJELOLESE
    for i in range(len(G)):
        if sum(item[1] for item in G[i]) == 0:
            A[i] = 0
            OK = 1

    ### 1-ES INDEXU CSUCSOK KIJELOLESE (MEG NEM LEHET JAVITO UT!)
    if OK:
        OK = 0
        for i in range(len(A)):
            if A[i] == 0:
                for j in range(len(G[0])):
                    if G[i][j] == [1, 0] and B[j] == -1:
                        B[j] = 1
                        OK = 1
    if OK:
        return 1
    else:
        return 0

def hun_repair (G):
    A = list(-1 for i in range(len(G)))
    B = list(-1 for i in range(len(G[0])))

    OK = hun_repair_init(G, A, B)
    enum = 1
    FIND = 0

    ### MINDEN 2. LEPES UTAN VIZSGALUNK
    while OK:
        enum += 1
        OK = 0
        for j in range(len(B)):
            if B[j] == enum - 1:
                for i in range(len(G)):
                    ### VAN EL ES MEG NEM JELOLTUK MEG A HOZZA TARTOZO CSUCSOT
                    if G[i][j] == [1, 1] and A[i] == -1:
                        A[i] = enum
                        OK = 1
        
        if OK:
            enum += 1
            OK = 0
            for i in range(len(A)):
                if A[i] == enum - 1:
                    for j in range(len(G[0])):
                        ### VAN EL ES MEG NEM JELOLTUK MEG A HOZZA TARTOZO CSUCSOT
                        if G[i][j] == [1, 0] and B[j] == -1:
                            B[j] = enum
                            OK = 1

                            ### VIZSGALAT, HOGY VEGE LESZ-E AZ ALGORITMUSNAK
                            FIND = 1
                            for k in range(len(G)):
                                if G[k][j] == [1, 1] or G[k][j] == [1, 4]:
                                    FIND = 0
                                    break
                            if FIND == 1:
                                last = j
                                break
                if FIND:
                    break

        ### LEALLAS
        if FIND == 1:
            break

    ### JAVITAS VEGREHAJTASA
    ### ### MIVEL PARATLAN SOK ELET KELL ATIRNI,
    ### ### EZERT AZ ELSOT KIVUL, MAJD WHILE CILUSBAN 2-ESEVEL
    ### ### ATIRANDO EL MEGTALALASA A TOMB SEGITSEGEVEL TORTENIK
    if FIND:
        enum -= 1
        for i in range(len(A)):
            if G[i][last] == [1, 0] and A[i] == enum:
                G[i][last][1] = 2
                last = i
                break

        while enum > 0:
            ### GRAF MATRIXABAN VIZSZINTESEN CSAK 1 EL LEHET KIVALASZTVA, AZT ATIRJUK
            for j in range(len(G[last])):
                if G[last][j] == [1, 1]:
                    G[last][j][1] = 0
                    last_new = j
                elif G[last][j] == [1, 2]:
                    G[last][j][1] = 1
            last = last_new

            ### AZ ELOBB MEGTALALT EL OSZLOPABAN MEGKERESSUK A JAVITOELT A TOMB SEGITSEGEVEL
            enum -= 2
            for i in range(len(A)):
                if G[i][last] == [1, 0] and A[i] == enum:
                    G[i][last][1] = 2
                    last = i
                    break

        for i in range(len(G[last])):
            if G[last][i] == [1, 2]:
                G[last][i][1] = 1
        return 1

    return 0


def whois(row, shifts):
    s = 0
    for i in range(len(shifts)):
        s += shifts[i]
        if s > row:
            return i


def hun_repair_double_init (G, A, B, shifts, admins):
    ### UA SIMPLE ES DOUBLE ESETEKBEN
    OK = 0
    ### 0-AS INDEXU CSUCSOK KIJELOLESE
    for i in range(len(G)):
        if sum(item[1] for item in G[i]) == 0:
            A[i] = 0
            OK = 1

    ### 1-ES INDEXU CSUCSOK KIJELOLESE (MEG NEM LEHET JAVITO UT!)
    if OK:
        OK = 0
        for row in range(len(A)):
            if A[row] == 0:
                for col in range(len(G[0])):
                    if G[row][col] == [1, 0] and B[col] == -1 and whois(row, shifts) not in admins[col]:
                        B[col] = 1
                        OK = 1
    if OK:
        return 1
    else:
        return 0


def hun_repair_double(G, shifts):
    A = list(-1 for i in range(len(G)))
    B = list(-1 for i in range(len(G[0])))
    admins = [set() for i in range(len(G[0]))]
    for col in range(len(G[0])):
        for row in range(len(G)):
            if G[row][col][1] in {1, 4}:
                admins[col].add(whois(row, shifts))

    ### UA MINT SIMPLE ESETBEN
    OK = hun_repair_double_init(G, A, B, shifts, admins)
    enum = 1
    FIND = 0

    ### MINDEN 2. LEPES UTAN VIZSGALUNK
    while OK:
        enum += 1
        OK = 0
        for j in range(len(B)):
            if B[j] == enum - 1:
                for i in range(len(G)):
                    ### VAN EL ES MEG NEM JELOLTUK MEG A HOZZA TARTOZO CSUCSOT
                    if G[i][j] == [1, 1] and A[i] == -1:
                        A[i] = enum
                        OK = 1

        if OK:
            enum += 1
            OK = 0
            for row in range(len(A)):
                if A[row] == enum - 1:
                    for col in range(len(G[0])):
                        ### VAN EL ES MEG NEM JELOLTUK MEG A HOZZA TARTOZO CSUCSOT
                        if G[row][col] == [1, 0] and B[col] == -1:
                            B[col] = enum
                            OK = 1

                            ### VIZSGALAT, HOGY VEGE LESZ-E AZ ALGORITMUSNAK
                            FIND = 0
                            s_edge = 0
                            for k in range(len(G)):
                                if G[k][col] == [1, 1] or G[k][col] == [1, 4]:
                                    s_edge += 1
                            if s_edge < 2:
                                FIND = 1
                                last = col
                                break
                    if FIND:
                        break

        ### LEALLAS
        if FIND == 1:
            break

    ### JAVITAS VEGREHAJTASA
    ### ### MIVEL PARATLAN SOK ELET KELL ATIRNI,
    ### ### EZERT AZ ELSOT KIVUL, MAJD WHILE CILUSBAN 2-ESEVEL
    ### ### ATIRANDO EL MEGTALALASA A TOMB SEGITSEGEVEL TORTENIK
    if FIND:
        enum -= 1
        for i in range(len(A)):
            if G[i][last] == [1, 0] and A[i] == enum:
                G[i][last][1] = 2
                last = i
                break

        while enum > 0:
            ### GRAF MATRIXABAN VIZSZINTESEN CSAK 1 EL LEHET KIVALASZTVA, AZT ATIRJUK
            for j in range(len(G[last])):
                if G[last][j] == [1, 1]:
                    G[last][j][1] = 0
                    last_new = j
                elif G[last][j] == [1, 2]:
                    G[last][j][1] = 1
            last = last_new

            ### AZ ELOBB MEGTALALT EL OSZLOPABAN MEGKERESSUK A JAVITOELT A TOMB SEGITSEGEVEL
            enum -= 2
            for i in range(len(A)):
                if G[i][last] == [1, 0] and A[i] == enum:
                    G[i][last][1] = 2
                    last = i
                    break

        for i in range(len(G[last])):
            if G[last][i] == [1, 2]:
                G[last][i][1] = 1
        return 1

    return 0


def graph_double_max_match (G, shifts, RANDOM):
    graph_bipart_double_init(G, shifts, RANDOM)
    print('Graph day after initialization:')
    for i in G:
        print(i)
    print()
    result_check(G, 2)
    while hun_repair_double(G, shifts):
        pass
    print('Graph day after repair:')
    for i in G:
        print(i)
    print()
    result_check(G, 2)


def main():

    G = [[[1, 0], [0, 0], [0, 0], [0, 0], [1, 0], [1, 0], [1, 1]],
        [[1, 0], [0, 0], [0, 0], [0, 0], [1, 1], [1, 0], [1, 0]],
        [[0, 0], [0, 0], [1, 0], [0, 0], [0, 0], [1, 1], [1, 0]],
        [[1, 0], [1, 0], [1, 0], [1, 1], [0, 0], [0, 0], [1, 0]],
        [[0, 0], [0, 0], [1, 1], [0, 0], [0, 0], [0, 0], [0, 0]],
        [[0, 0], [1, 1], [1, 0], [1, 0], [0, 0], [0, 0], [1, 0]],
        [[0, 0], [1, 0], [1, 0], [1, 0], [1, 0], [0, 0], [0, 0]]]

    G = [[[1, 0], [1, 1], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0]],
        [[1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 1]],
        [[1, 0], [1, 0], [1, 0], [1, 0], [1, 1], [1, 0], [1, 0]],
        [[1, 0], [1, 0], [1, 1], [1, 0], [1, 0], [1, 0], [1, 0]],
        [[1, 0], [1, 0], [1, 0], [1, 0], [1, 1], [1, 0], [1, 0]],
        [[1, 0], [1, 0], [1, 0], [1, 1], [1, 0], [1, 0], [1, 0]],
        [[1, 0], [1, 1], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0]],
        [[1, 0], [1, 0], [1, 1], [1, 0], [1, 0], [1, 0], [1, 0]],
        [[1, 1], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0]],
        [[1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 1]],
        [[1, 0], [1, 0], [1, 0], [1, 1], [1, 0], [1, 0], [1, 0]],
        [[1, 1], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0]],
        [[1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 1], [1, 0]],
        [[1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0], [1, 0]]]

    shifts = [2, 2, 2, 1, 3, 2, 2]
    print('Kezdeti ertekek')
    for i in G:
        print(i)
    print()
    result_check(G, 2)
    
    hun_repair_double(G, shifts) 
    print('Hun repair utan')
    for i in G:
        print(i)
    print()
    result_check(G, 2)


main()
